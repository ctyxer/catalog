<%- include('particles/header.ejs') %>

<%- include('particles/navigation.ejs') %>

<% if(item.author == username) { %>
<a href="/items/<%= item.id %>/change" class="form-button" style="float: right; margin-right: 20px; text-decoration: none;">Изменить</a>
<% } %>
<div name="item" class="rounded-md border-4 border-black p-3 m-1">
  <img class="inline-block rounded-2xl max-h-60 max-w-60 pr-2" src="../img/<%= item.image %>" />
  <div class="inline-block">
    <h2 class="text-lg font-bold mb-auto">
      <%= item.title %>
    </h2>
    <p href="/users/<%= item.author %>" class="mr-auto">
      Автор - <%= item.author %>
    </p>
    <p class="text-gray-600">
      Добавлено - <%= item.date_creating %>
    </p>
  </div>
</div>

<div class="rounded-md border-4 border-black p-3 m-1">
  <p>
    Описание:
  </p>
  <p class="font-bold">
    <%= item.description %>
  </p>
</div>

<p class="font-bold m-5">Комментарии<%if(comments.length==0){%> отсутствуют<%}else{%>:<%}%></p>

<% for (let i = 0; i < comments.length; i++) { %>

<div class="rounded-md border-4 border-black p-3 m-1">
  <p class="text-blue-900 font-bold">
    <%=comments[i].author%>
  </p>

  <p class="bg-blue-200 rounded-md p-1">
    <%=comments[i].commentary%>
  </p>
  <p class="text-xs inline-block">
    Добавлено - <%=comments[i].date%>
  </p>
  <% if(comments[i].author == username){ %>
  <form action="/deleteCommentary" method="post" class=" text-red-600 font-bold inline-block ml-auto">
    <input type="hidden" value="<%=comments[i].id%>" type="text" name="idComment">
    <input type="hidden" value="<%= item.id %>" type="text" name="id">
    <input type="submit" class="form-button" value="Удалить">
  </form>
  <% } %>
</div>
<% } %>

<% if(auth) { %>
<form action="/addCommentary" method="post">

  <div class="comment__block">
    <p style="margin-left: 5px;">Добавить комментарий</p>
    <span>
      <input type="text" name="commentary" class="comment">
      <input type="hidden" value="<%= item.id %>" type="text" name="id">
      <input type="submit" class="form-button" value="Добавить">
    </span>
  </div>
</form>
<% } %>

<%- include('particles/footer.ejs') %>